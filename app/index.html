<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="Dark War - A retro-futuristic roguelike"
    />
    <title>Dark War</title>
    <link rel="stylesheet" href="assets/css/system.css" />
    <link rel="stylesheet" href="assets/css/styles.css" />
  </head>
  <body>
    <div class="app-container">
      <div class="game-area">
        <div class="viewport">
          <canvas
            id="game"
            width="2080"
            height="1184"
            aria-label="Game canvas"
            role="img"
          ></canvas>
        </div>
        <button
          class="scale-toggle"
          id="scaleToggle"
          aria-label="Toggle scale"
          title="Toggle scale (1X/2X/3X)"
        >
          2X
        </button>
      </div>

      <aside class="sidebar" id="sidebar">
        <section class="status panel">
          <h2>Status</h2>
          <div class="stats-grid">
            <div class="stat-row">
              <span class="stat-label">Region</span>
              <span class="stat-value" id="floor">1</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Score</span>
              <span class="stat-value" id="score">0</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Mode</span>
              <span class="stat-value" id="mode">Planning</span>
            </div>
            <div class="hp stat-row">
              <span class="stat-label">Hit Points</span>
              <span class="stat-value" id="hp">—</span>
            </div>
            <div class="hp-bar" id="hpbar" style="--hp-width: 100%">
              <span class="hp-bar-fill"></span>
            </div>
          </div>
        </section>

        <section class="inventory panel">
          <h2>Inventory</h2>
          <div id="inventory"></div>
        </section>

        <section class="message-log panel">
          <h2>Message Log</h2>
          <ul id="log"></ul>
        </section>

        <section class="controls panel">
          Move: <kbd>Numeric Keypad</kbd><br />
          Pickup: <kbd>G</kbd><br />
          Open/Close: <kbd>O</kbd> + <kbd>Numeric Keypad</kbd><br />
          Stairs: <kbd>&lt;</kbd><br />
          Fire: <kbd>F</kbd> + <kbd>Numeric Keypad</kbd><br />
          Reload: <kbd>R</kbd><br />
          Toggle FOV: <kbd>V</kbd><br />
          <br />
          <strong>Time Controls</strong><br />
          Toggle Mode: <kbd>P</kbd><br />
          Pause: <kbd>Space</kbd><br />
          Resume: <kbd>Enter</kbd><br />
        </section>
      </aside>
      <button
        class="sidebar-toggle"
        id="sidebarToggle"
        aria-label="Toggle sidebar"
        title="Toggle sidebar"
      >
        ▶
      </button>
    </div>

    <script src="game.js"></script>
    <script>
      const sidebar = document.getElementById("sidebar");
      const sidebarToggle = document.getElementById("sidebarToggle");

      sidebarToggle.addEventListener("click", () => {
        const isCollapsed = sidebar.classList.toggle("collapsed");
        sidebarToggle.textContent = isCollapsed ? "◀" : "▶";
        sidebarToggle.setAttribute(
          "aria-label",
          isCollapsed ? "Show Sidebar" : "Hide Sidebar",
        );
      });

      // Scale toggle functionality
      const scaleToggle = document.getElementById("scaleToggle");
      const scales = [1, 2, 3];
      let currentScaleIndex = 1; // Start at 2X

      scaleToggle.addEventListener("click", () => {
        // Cycle to next scale
        currentScaleIndex = (currentScaleIndex + 1) % scales.length;
        const newScale = scales[currentScaleIndex];

        // Update button text
        scaleToggle.textContent = `${newScale}X`;

        // Update renderer scale if available
        if (window.darkWarApp && window.darkWarApp.setScale) {
          window.darkWarApp.setScale(newScale);
        }
      });
    </script>
  </body>
</html>
