<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="Dark War - A retro-futuristic roguelike"
    />
    <title>Dark War</title>
    <style>
      :root {
        --bg: #0c0f12;
        --panel: #141922;
        --ink: #e6edf3;
        --ink-dim: #a9b1bb;
        --border: rgba(255, 255, 255, 0.06);
        --danger: #ff6b6b;
        --warn: #ffd166;
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      html,
      body {
        height: 100%;
        background: var(--bg);
        color: var(--ink);
        font: 14px/1.5 system-ui, -apple-system, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, sans-serif;
        overflow: hidden;
      }

      .app-container {
        display: flex;
        height: 100vh;
        width: 100vw;
      }

      .game-area {
        flex: 1;
        display: flex;
        flex-direction: column;
        min-width: 0;
        background: var(--bg);
      }

      .viewport {
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 16px;
        background: #0b0e12;
        overflow: hidden;
        position: relative;
      }

      #game {
        display: block;
        image-rendering: pixelated;
        image-rendering: crisp-edges;
        max-width: 100%;
        max-height: 100%;
        width: auto;
        height: auto;
        object-fit: contain;
      }

      .sidebar {
        width: 340px;
        background: var(--panel);
        border-left: 1px solid var(--border);
        display: flex;
        flex-direction: column;
        overflow: hidden;
        transition: margin-right 0.3s ease;
        flex-shrink: 0;
      }

      .sidebar.collapsed {
        margin-right: -340px;
      }

      .sidebar-toggle {
        position: fixed;
        right: 0;
        top: 50%;
        transform: translateY(-50%);
        background: var(--panel);
        border: 1px solid var(--border);
        border-right: none;
        border-radius: 8px 0 0 8px;
        padding: 12px 8px;
        cursor: pointer;
        z-index: 100;
        transition: right 0.3s ease;
        color: var(--ink);
        font-size: 18px;
        line-height: 1;
        font-weight: 500;
      }

      .sidebar-toggle:hover {
        background: #1a2030;
      }

      .sidebar-toggle:focus {
        outline: 2px solid var(--border);
        outline-offset: -2px;
      }

      .sidebar-toggle:active {
        transform: translateY(-50%);
      }

      .sidebar.collapsed ~ .sidebar-toggle {
        right: 0;
      }

      .sidebar:not(.collapsed) ~ .sidebar-toggle {
        right: 340px;
      }

      .panel-section {
        padding: 16px;
        border-bottom: 1px solid var(--border);
      }

      .panel-section:last-child {
        border-bottom: none;
      }

      .panel-section h2 {
        font-size: 13px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        color: var(--ink-dim);
        margin-bottom: 12px;
      }

      /* Stats grid */
      .stats-grid {
        display: grid;
        gap: 8px;
      }

      .stat-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 4px 0;
      }

      .stat-label {
        color: var(--ink-dim);
        font-size: 13px;
      }

      .stat-value {
        font-weight: 600;
        font-size: 14px;
      }

      .hp-bar-container {
        margin-top: 4px;
      }

      .hp-bar {
        height: 10px;
        background: #1d2633;
        border-radius: 6px;
        overflow: hidden;
        position: relative;
      }

      .hp-bar-fill {
        display: block;
        height: 100%;
        background: linear-gradient(90deg, var(--danger), var(--warn));
        width: 100%;
        transition: width 0.3s ease;
      }

      #inventory {
        color: var(--ink-dim);
        font-size: 13px;
        padding: 8px 0;
      }

      .message-log {
        flex: 1;
        overflow-y: auto;
        overflow-x: hidden;
        padding: 16px;
        font-family: ui-monospace, "SF Mono", Menlo, Consolas, monospace;
        font-size: 12px;
        line-height: 1.6;
        background: #0b0e12;
      }

      .message-log::-webkit-scrollbar {
        width: 8px;
      }

      .message-log::-webkit-scrollbar-track {
        background: transparent;
      }

      .message-log::-webkit-scrollbar-thumb {
        background: #222a36;
        border-radius: 4px;
      }

      .message-log::-webkit-scrollbar-thumb:hover {
        background: #2d3748;
      }

      .controls-section {
        padding: 16px;
        font-size: 12px;
        line-height: 1.8;
        color: var(--ink-dim);
      }

      .controls-section kbd {
        background: #0f1420;
        border: 1px solid #222a36;
        padding: 2px 6px;
        border-radius: 4px;
        font-size: 11px;
        font-family: ui-monospace, monospace;
        white-space: nowrap;
      }

      @media (max-width: 1024px) {
        .sidebar {
          position: fixed;
          right: 0;
          top: 0;
          height: 100vh;
          z-index: 50;
        }

        .sidebar.collapsed {
          margin-right: -340px;
        }
      }
    </style>
  </head>
  <body>
    <div class="app-container">
      <div class="game-area">
        <div class="viewport">
          <canvas
            id="game"
            width="2080"
            height="1184"
            aria-label="Game canvas"
            role="img"
          ></canvas>
        </div>
      </div>

      <aside class="sidebar" id="sidebar">
        <div class="panel-section">
          <h2>Status</h2>
          <div class="stats-grid">
            <div class="stat-row">
              <span class="stat-label">Region</span>
              <span class="stat-value" id="floor">1</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Hit Points</span>
              <span class="stat-value" id="hp">—</span>
            </div>
            <div class="hp-bar-container">
              <div class="hp-bar">
                <span class="hp-bar-fill" id="hpbar" style="width: 100%"></span>
              </div>
            </div>
            <div class="stat-row">
              <span class="stat-label">Score</span>
              <span class="stat-value" id="score">0</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Mode</span>
              <span class="stat-value" id="mode">Planning</span>
            </div>
          </div>
        </div>

        <div class="panel-section">
          <h2>Inventory</h2>
          <div id="inventory" class="inventory-empty">Empty</div>
        </div>
        <div class="message-log" id="log" aria-live="polite"></div>
        <div class="controls-section">
          Move: <kbd>Numeric Keypad</kbd><br />
          Pickup: <kbd>G</kbd><br />
          Open/Close: <kbd>O</kbd> + <kbd>Numeric Keypad</kbd><br />
          Stairs: <kbd>&lt;</kbd><br />
          Fire: <kbd>F</kbd> + <kbd>Numeric Keypad</kbd><br />
          Reload: <kbd>R</kbd><br />
          Toggle FOV: <kbd>V</kbd><br />
          <br />
          <strong>Time Controls:</strong><br />
          Toggle Mode: <kbd>P</kbd><br />
          Pause: <kbd>Space</kbd><br />
          Resume: <kbd>Enter</kbd><br />
        </div>
      </aside>
      <button
        class="sidebar-toggle"
        id="sidebarToggle"
        aria-label="Toggle sidebar"
        title="Toggle sidebar"
      >
        ▶
      </button>
    </div>

    <script src="game.js"></script>
    <script>
      const sidebar = document.getElementById("sidebar");
      const sidebarToggle = document.getElementById("sidebarToggle");

      sidebarToggle.addEventListener("click", () => {
        const isCollapsed = sidebar.classList.toggle("collapsed");
        sidebarToggle.textContent = isCollapsed ? "◀" : "▶";
        sidebarToggle.setAttribute(
          "aria-label",
          isCollapsed ? "Show Sidebar" : "Hide Sidebar"
        );
      });
    </script>
  </body>
</html>
